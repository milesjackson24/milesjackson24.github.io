(this["webpackJsonparup-hub"]=this["webpackJsonparup-hub"]||[]).push([[0],{47:function(e,n,t){},48:function(e,n,t){},77:function(e,n,t){"use strict";t.r(n);var c=t(0),o=t.n(c),a=t(13),i=t.n(a),r=(t(47),t.p,t(48),t(32)),l=t.n(r),s=t(108),u=t(12),d=t(103),f=t(106),j=t(105),h=t(101),b=t(104),m=t(107),p=t(102),g=t(52),O=function(e){var n=Object(c.useState)([]),t=Object(u.a)(n,2),o=t[0],a=t[1],i=Object(c.useState)([]),r=Object(u.a)(i,2),l=r[0],s=r[1],d=Object(c.useState)(!1),f=Object(u.a)(d,2),j=f[0],h=f[1],b=function(){g.get("https://bmtools.arup.com/calcs/api/mechanical/pwadata/".concat(e.account.userName)).then((function(e){a(e.data.calcs)}))};Object(c.useEffect)((function(){b(),s(o)}),[]),Object(c.useEffect)((function(){var n=setInterval((function(){return g.get("https://bmtools.arup.com/calcs/api/mechanical/pwadata/".concat(e.account.userName)).then((function(e){s(e.data.calcs)})),function(){return clearInterval(n)}}),6e4)}),[]),Object(c.useEffect)((function(){l.length>o.length?Notification.requestPermission().then((function(){new Notification("You have a new Calculation to complete").onclick=function(e){e.preventDefault(),window.open("https://bmtools.arup.com/calcs/mechanical/mycalcs","_blank")}})):l.length<o.length&&Notification.requestPermission().then((function(){new Notification("Well done! You've completed a Calculation, only ".concat(l.length," more to go."))})),console.log(l,o),h(!0)}),[l]),Object(c.useEffect)((function(){!0===j&&(b(),h(!1)),console.log(o,l)}),[j]);return{myCalcs:o,completeCalc:function(e){window.open("https://bmtools.arup.com/calcs/mechanical/project/".concat(e.ProjectCode),"_blank")}}},v=t(99),w=Object(v.a)({table:{width:900,marginTop:50,margin:"auto"}}),x=t(3);function N(e){var n=e.userData,t=O(n),c=t.myCalcs,o=t.completeCalc,a=w();return Object(x.jsx)("div",{children:Object(x.jsx)(h.a,{component:p.a,className:a.table,children:Object(x.jsxs)(d.a,{children:[Object(x.jsxs)(b.a,{children:[Object(x.jsx)(j.a,{children:"Calculation Name"}),Object(x.jsx)(j.a,{children:"Project Name"}),Object(x.jsx)(j.a,{children:"Project Number"}),Object(x.jsx)(j.a,{children:"Stage"}),Object(x.jsx)(j.a,{})]}),Object(x.jsx)(f.a,{children:c.map((function(e){return Object(x.jsxs)(m.a,{children:[Object(x.jsx)(j.a,{children:e.calculation}),Object(x.jsx)(j.a,{children:e.JobNameShort}),Object(x.jsx)(j.a,{children:e.ProjectCode}),Object(x.jsx)(j.a,{children:e.stage}),Object(x.jsx)(j.a,{children:Object(x.jsx)(s.a,{variant:"contained",onClick:function(){return o(e)},children:"Complete Calc"})})]},e.calculation_id)}))})]})})})}var k=Object(v.a)({loginScreen:{margin:"auto",marginTop:"20%"}});function C(){var e=function(){var e=Object(c.useState)(!1),n=Object(u.a)(e,2),t=n[0],o=n[1],a=Object(c.useState)(!1),i=Object(u.a)(a,2),r=i[0],l=i[1],s=Object(c.useState)([]),d=Object(u.a)(s,2),f=d[0],j=d[1],h=function(){Notification.requestPermission().then((function(){new Notification("You have 4 new calculations to complete, click to view").onclick=function(e){e.preventDefault(),window.open("https://bmtools.arup.com/calcs/mechanical/project/demo","_blank")}}))};return Object(c.useEffect)((function(){t&&(console.log("timed notification"),h(),o(!1))}),[t]),{handleNotification:h,loggedIn:r,authHandler:function(e,n){console.log(e,n),n&&(j(n),l(!0))},userData:f}}(),n=e.handleNotification,t=e.loggedIn,o=e.authHandler,a=e.userData,i=k();return Object(x.jsxs)("div",{children:[!t&&Object(x.jsx)(l.a,{clientId:"2b4cf606-ac2c-4532-a7b0-483d7f2427cc",authCallback:o,className:i.loginScreen}),t&&Object(x.jsxs)("div",{children:[Object(x.jsx)("h1",{children:"Arup Hub"}),Object(x.jsx)(s.a,{variant:"contained",onClick:n,children:"Send me a Notification"}),Object(x.jsx)(N,{userData:a})]})]})}var S=function(){return Object(x.jsx)("div",{className:"App",children:Object(x.jsx)(C,{})})},y=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,110)).then((function(n){var t=n.getCLS,c=n.getFID,o=n.getFCP,a=n.getLCP,i=n.getTTFB;t(e),c(e),o(e),a(e),i(e)}))},P=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function E(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all "),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(Object(x.jsx)(o.a.StrictMode,{children:Object(x.jsx)(S,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");P?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var c=t.headers.get("content-type");404===t.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):E(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service ")}))):E(n,e)}))}}(),y()}},[[77,1,2]]]);
//# sourceMappingURL=main.220a3253.chunk.js.map